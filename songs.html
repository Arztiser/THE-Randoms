<script>
    function toggleMenu() {
        const topnav = document.querySelector('.topnav');
        const body = document.body;

        topnav.classList.toggle('active');
        body.classList.toggle('menu-open', topnav.classList.contains('active'));
    }

    let lastSongIndex = -1;
    let retryCount = 0; // to prevent looping indefinitely

    function getRandomSong() {
        const songs = [
            'audio/Crazy_Hazy_Dream.mp3',
            'audio/Name_Song.mp3',
            'audio/Arbitrary_Awareness.mp3',
            'audio/Eternal_Enthusiasm.mp3',
            'audio/Amusing_Adventure.mp3',
            'audio/Definite_Delight.mp3',
            'audio/Fabulous_Fun.mp3',
            'audio/Magical_Memory.mp3',
            // Add more songs here
        ];

        // Ensure a different song is selected, retry only a few times if needed
        let randomIndex;
        do {
            randomIndex = Math.floor(Math.random() * songs.length);
        } while (randomIndex === lastSongIndex && retryCount < 5);

        // Reset retry count for the next call
        retryCount = (randomIndex === lastSongIndex) ? retryCount + 1 : 0;

        lastSongIndex = randomIndex;
        const randomSong = songs[randomIndex];

        const audioPlayer = document.getElementById('audio-player');
        const randomParam = Math.floor(Math.random() * 1000000); // Generate a larger unique param
        audioPlayer.src = `${randomSong}?v=${randomParam}`;

        audioPlayer.onerror = function () {
            console.error("Failed to load audio. Retrying...");
            getRandomSong();
        };

        audioPlayer.load();
        audioPlayer.play();
    }

    window.onload = getRandomSong;
    document.getElementById('generate-button').addEventListener('click', getRandomSong);
</script>
