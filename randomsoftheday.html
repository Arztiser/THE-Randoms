<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#E82B38" />
  <meta name="description" content="Randoms Of The Day - THE Randoms" />
  <title>Randoms Of The Day - THE Randoms</title>
  <link rel="icon" type="image/png" href="./img/pfp.png" />
  <link href="https://fonts.googleapis.com/css2?family=Jersey+10:wght@100;300;400;500;700;900&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Jersey 10', sans-serif;
      font-size: 28px;
      margin: 20px;
      background: #fff;
      color: #000;
      text-align: center;
    }
    h1 {
      font-weight: 700;
      margin-bottom: 20px;
    }
    #generate-card, #copy-card, #download-card {
      font-family: 'Jersey 10', sans-serif;
      font-size: 20px;
      padding: 10px 20px;
      margin: 10px 5px;
      border: 2px solid #E82B38;
      border-radius: 8px;
      background-color: #E82B38;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    #generate-card:hover, #copy-card:hover, #download-card:hover {
      background-color: #c91f2c;
      transform: scale(1.05);
    }
    #card-output {
      margin-top: 30px;
      font-size: 22px;
      line-height: 1.5;
      white-space: pre-wrap;
      text-align: left;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      border: 2px solid #E82B38;
      border-radius: 10px;
      padding: 20px;
      background: #f9f9f9;
    }
  </style>
</head>
<body>

  <h1>Randoms Of The Day</h1>

  <button id="generate-card">Generate Randoms Of The Day Card</button>
  <button id="copy-card" disabled>Copy Card Text</button>
  <button id="download-card" disabled>Download Card as Image</button>

  <div id="card-output" aria-live="polite" aria-atomic="true"></div>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <script>
    const generateBtn = document.getElementById('generate-card');
    const copyBtn = document.getElementById('copy-card');
    const downloadBtn = document.getElementById('download-card');
    const cardOutput = document.getElementById('card-output');

    // Your YouTube API Key
    const YOUTUBE_API_KEY = 'AIzaSyA7B_YMNe5T-rrVRuEbcZKcY9w50EWCeVk';

    // Reddit subreddits for memes
    const redditSubs = ["memes", "dankmemes", "funny"];

    async function fetchRandomJoke() {
      const res = await fetch('https://v2.jokeapi.dev/joke/Any?type=single');
      const data = await res.json();
      return data.joke || "No joke found.";
    }

    async function fetchRandomQuote() {
      const res = await fetch('https://api.quotable.io/random');
      const data = await res.json();
      return `"${data.content}" â€” ${data.author}`;
    }

    async function fetchRandomNumberFact() {
      const num = Math.floor(Math.random() * 1000);
      const res = await fetch(`http://numbersapi.com/${num}/trivia`);
      const fact = await res.text();
      return fact;
    }

    async function fetchRandomLetter() {
      const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      return letters.charAt(Math.floor(Math.random() * letters.length));
    }

    async function fetchRandomWord() {
      const res = await fetch('https://random-word-api.vercel.app/api?words=1');
      const data = await res.json();
      return data[0] || "random";
    }

    async function fetchRandomMeme() {
      const sub = redditSubs[Math.floor(Math.random() * redditSubs.length)];
      const res = await fetch(`https://www.reddit.com/r/${sub}/hot.json?limit=100`);
      const data = await res.json();
      const posts = data.data.children.filter(post => !post.data.over_18 && post.data.post_hint === 'image');
      if(posts.length === 0) return { title: "No memes found", url: "" };
      const post = posts[Math.floor(Math.random() * posts.length)].data;
      return { title: post.title, url: post.url };
    }

    async function fetchRandomYouTubeVideo() {
      // Let's search for "funny" videos on YouTube and pick one random item from first 25
      const searchURL = `https://www.googleapis.com/youtube/v3/search?key=${YOUTUBE_API_KEY}&part=snippet&type=video&q=funny&maxResults=25`;
      const res = await fetch(searchURL);
      const data = await res.json();
      if(!data.items || data.items.length === 0) return { title: "No video found", url: "" };
      const item = data.items[Math.floor(Math.random() * data.items.length)];
      const videoId = item.id.videoId;
      const title = item.snippet.title;
      const url = `https://www.youtube.com/watch?v=${videoId}`;
      return { title, url };
    }

    async function generateCard() {
      cardOutput.textContent = "Loading random data...";
      copyBtn.disabled = true;
      downloadBtn.disabled = true;

      try {
        const [joke, quote, numberFact, letter, word, meme, video] = await Promise.all([
          fetchRandomJoke(),
          fetchRandomQuote(),
          fetchRandomNumberFact(),
          fetchRandomLetter(),
          fetchRandomWord(),
          fetchRandomMeme(),
          fetchRandomYouTubeVideo()
        ]);

        // Format card text nicely
        let cardText = `ðŸŽ² THE RANDOMS OF THE DAY ðŸŽ²

JOKE:
${joke}

QUOTE:
${quote}

NUMBER FACT:
${numberFact}

LETTER OF THE DAY:
${letter}

WORD OF THE DAY:
${word}

MEME OF THE DAY:
${meme.title}
${meme.url}

YOUTUBE VIDEO OF THE DAY:
${video.title}
${video.url}
`;

        cardOutput.textContent = cardText;
        copyBtn.disabled = false;
        downloadBtn.disabled = false;

      } catch (e) {
        cardOutput.textContent = "Failed to fetch random data. Please try again later.";
        copyBtn.disabled = true;
        downloadBtn.disabled = true;
        console.error(e);
      }
    }

    generateBtn.addEventListener('click', generateCard);

    copyBtn.addEventListener('click', () => {
      if(!cardOutput.textContent) return;
      navigator.clipboard.writeText(cardOutput.textContent).then(() => {
        alert("Randoms Of The Day card copied to clipboard!");
      }).catch(() => {
        alert("Failed to copy. Please copy manually.");
      });
    });

    downloadBtn.addEventListener('click', () => {
      if(!cardOutput.textContent) return;

      // Use html2canvas to convert text to image
      html2canvas(cardOutput, {backgroundColor: "#f9f9f9"}).then(canvas => {
        const link = document.createElement('a');
        link.download = 'randoms_of_the_day.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    });
  </script>

</body>
</html>
